{extend name="base" /}
{block name="body"}
<style>
    .area_div .layui-input-inline {
        width: 160px;
    }
</style>
<div class="layui-body">
    <!--tab标签-->
    <div class="layui-tab layui-tab-brief">
        <ul class="layui-tab-title">
            <li class=""><a href="{:url('manage/customer/index')}">用户管理</a></li>
            <li class="" style="display: none"><a href="{:url('manage/customer/add')}">添加用户</a></li>
            <li class="layui-this">编辑用户</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show">
                <form class="layui-form form-container" action="{:url('manage/customer/update')}" method="post">
                    <div class="layui-form-item">
                        <label class="layui-form-label">电话号码</label>
                        <div class="layui-input-block">
                            <input type="text" name="mobile_phone" value="{$customer['mobile_phone']}" required
                                   lay-verify="required"
                                   placeholder="请输入手机号码" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">真实姓名</label>
                        <div class="layui-input-block">
                            <input type="text" name="customer_name" value="{$customer['customer_name']}"
                                   placeholder="（选填）请输入真实姓名"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">身份证号码</label>
                        <div class="layui-input-block">
                            <input type="text" name="id_number" id="id_number" value="{$customer['id_number']}"
                                   placeholder="（选填）请输入身份证号码" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">身份证图片正面</label>
                        <div class="layui-input-block">
                            <input type="text" name="id_number_image_front" value="{$customer['id_number_image_front']}"
                                   placeholder="（选填）请上传图片"
                                   class="layui-input layui-input-inline" id="thumb_id_number_front">
                            <input type="file" name="file" accept="image/png"
                                   onclick="upload_img('/index.php/api/upload/upload.html?type=id_number','thumb_id_number_front')"
                                   class="layui-upload-file">
                            <img id="thumb_id_number_front_img" onclick="show_img($(this))"
                                 src="__OSSIMG__{$customer['id_number_image_front']}" style="height: 40px">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">身份证图片反面</label>
                        <div class="layui-input-block">
                            <input type="text" name="id_number_image_reverse"
                                   value="{$customer['id_number_image_reverse']}" placeholder="（选填）请上传图片"
                                   class="layui-input layui-input-inline" id="thumb_id_number_reverse">
                            <input type="file" name="file" accept="image/png"
                                   onclick="upload_img('/index.php/api/upload/upload.html?type=id_number','thumb_id_number_reverse')"
                                   class="layui-upload-file">
                            <img id="thumb_id_number_reverse_img" onclick="show_img($(this))"
                                 src="__OSSIMG__{$customer['id_number_image_reverse']}" style="height: 40px">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">客户邮箱</label>
                        <div class="layui-input-block">
                            <input type="text" name="email" value="{$customer['email']}" placeholder="（选填）请输入客户邮箱"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">客户昵称</label>
                        <div class="layui-input-block">
                            <input type="text" name="customer_nickname" value="{$customer['customer_nickname']}"
                                   placeholder="（选填）请输入客户昵称"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">客户性别</label>
                        <div class="layui-input-block">
                            <input type="radio" name="customer_sex" value="1" title="男" {if
                                   condition="$customer['customer_sex']==1" } checked="checked" {/if}>
                            <input type="radio" name="customer_sex" value="0" title="女" {if
                                   condition="$customer['customer_sex']==0" } checked="checked" {/if}>
                        </div>
                    </div>
                    <div id="p2" class="area_div">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">客户地址</label>
                        <div class="layui-input-block">
                            <input type="text" name="address" value="{$customer['address']}" placeholder="（选填）请输入客户地址"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">驾驶证档案编号</label>
                        <div class="layui-input-block">
                            <input type="text" name="driver_license" id="driver_license"
                                   value="{$customer['driver_license']}" placeholder="（选填）请输入客户驾驶证档案编号"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">驾驶证档案编号图片正面</label>
                        <div class="layui-input-block">
                            <input type="text" name="driver_license_image_front"
                                   value="{$customer['driver_license_image_front']}" placeholder="（选填）请上传图片"
                                   class="layui-input layui-input-inline" id="thumb_driver_license_front">
                            <input type="file" name="file" accept="image/png"
                                   onclick="upload_img('/index.php/api/upload/upload.html?type=driver_license','thumb_driver_license_front')"
                                   class="layui-upload-file">
                            <img id="thumb_driver_license_front_img" onclick="show_img($(this))"
                                 src="__OSSIMG__{$customer['driver_license_image_front']}" style="height: 40px">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">驾驶证档案编号图片副页</label>
                        <div class="layui-input-block">
                            <input type="text" name="driver_license_image_attach"
                                   value="{$customer['driver_license_image_attach']}" placeholder="（选填）请上传图片"
                                   class="layui-input layui-input-inline" id="thumb_driver_license_attach">
                            <input type="file" name="file" accept="image/png"
                                   onclick="upload_img('/index.php/api/upload/upload.html?type=driver_license','thumb_driver_license_attach')"
                                   class="layui-upload-file">
                            <img id="thumb_driver_license_attach_img" onclick="show_img($(this))"
                                 src="__OSSIMG__{$customer['driver_license_image_attach']}" style="height: 40px">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">人脸自拍</label>
                        <div class="layui-input-block">
                            <input type="text" name="customer_front"
                                   value="{$customer['customer_front']}" placeholder="（选填）请上传图片"
                                   class="layui-input layui-input-inline" id="thumb_customer_front">
                            <input type="file" name="file" accept="image/png"
                                   onclick="upload_img('/index.php/api/upload/upload.html?type=customerfront','customer_front')"
                                   class="layui-upload-file">
                            <img id="thumb_customer_front_img" onclick="show_img($(this))"
                                 src="__OSSIMG__{$customer['customer_front']}" style="height: 40px">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">客户QQ</label>
                        <div class="layui-input-block">
                            <input type="text" name="qq" value="{$customer['qq']}" placeholder="（选填）请输入客户QQ"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注信息</label>
                        <div class="layui-input-block">
                            <input type="text" name="customer_remark" required lay-verify="required"
                                   value="{$customer['customer_remark']}" placeholder="（必填）请输入备注信息"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">状态</label>
                        <div class="layui-input-block">
                            {foreach name="status_list" item="vo" key="kv"}
                            {if condition="$customer['customer_status']==$kv" }
                            <input type="radio" name="customer_status" value="{$kv}" checked="checked" title="{$vo}">
                            {else/}
                            <input type="radio" name="customer_status" value="{$kv}" title="{$vo}">
                            {/if}
                            {/foreach}
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <a style="margin-left: 50px" href="{:url('manage/customer/reset_approve',['id'=>$customer['id']])}"
                           class="layui-btn  ajax-common">重新认证</a>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <input type="number" value="{$customer['id']}" name="id" hidden>
                            <button class="layui-btn" lay-submit lay-filter="*">保存</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{/block}
{block name="js"}
<script type="text/javascript" src="__JS__/picker.js"></script>
{/block}
{block name="script"}
<script>
    $(function () {
        var picker = layui.picker;
        var p2 = new picker();
        p2.set({
            elem: '#p2',
            url: "{:url('api/Area/get_province_list')}",
            canSearch: true,
            codeConfig: {$address_config}
        }).render();
    });
</script>
<script>
    function upload_img(url, id) {
        layui.upload({
            url: url,
            type: 'image',
            ext: 'jpg|png|gif|bmp',
            success: function (data) {
                if (data.error === 0) {
                    document.getElementById(id).value = data.url;
                    document.getElementById(id + "_img").src = "__PUBLIC__" + data.url;
                } else {
                    layer.msg(data.message);
                }
            }
        });
    }

    function show_img(node) {
        var imgurl = node.attr('src');
        var title = node.attr('data-title');
        var texts = "<img src='" + imgurl + "' width='100%'/>";
        layer.open({
            title: title,
            area: 'auto',
            content: texts
        });
    }
</script>
{/block}